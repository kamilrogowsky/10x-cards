---
import Layout from "../layouts/Layout.astro";
import { LibraryPage } from "../components/library/LibraryPage";
import { ErrorBoundary } from "../components/ErrorBoundary";
import { TopBar } from "../components/TopBar";

// Get authentication status and user from middleware
const authenticated = Astro.locals.authenticated || false;
const userId = Astro.locals.user_id;
const user = Astro.locals.user;

// Log authentication status for debugging
console.log('Library page - Authenticated:', authenticated, 'User ID:', userId);
---

<Layout 
  title="Moje Fiszki - 10xCards" 
  description="Przeglądaj, twórz, edytuj i usuwaj swoje fiszki w bibliotece 10xCards"
>
  <ErrorBoundary client:load>
    <TopBar client:load user={user} />
    <main className="pt-16">
      <LibraryPage client:load authenticated={authenticated} />
    </main>
  </ErrorBoundary>
</Layout> 